\ifdefined\PRINT
\else
\setlrmargins{*}{*}{1}
\fi
\checkandfixthelayout
\pagestyle{ruled}
\chapterstyle{hangnum}
\setsecnumdepth{subsubsection}

\usepackage{xeCJK}
\setCJKmainfont{FandolSong-Regular.otf}
\setlength{\parindent}{0pt}
\DoubleSpacing

\usepackage{standalone}
\newenvironment{preview-page}{
\onlyifstandalone{\preview}
}{
\onlyifstandalone{\endpreview}
}

\usepackage{currfile}
\usepackage{xargs}

\usepackage{amsmath}
\usepackage{hyperref}

\setlength{\epigraphwidth}{0.8\textwidth}

\usepackage{enumitem}
\setlist[enumerate]{noitemsep,topsep=0pt}
\setlist[itemize]{noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt}

\usepackage{listings}
\lstset{
  language={},
  breaklines=true,
  basicstyle=\ttfamily,
  frame=tb,
  numberstyle=\tiny,
  captionpos=t,
  breakindent=0pt,
  breakautoindent=false}

\newcounter{erlangshellsession}[section]
\newoutputstream{erlangshellsession}
\newenvironment{ErlangShellSession}{
\stepcounter{erlangshellsession}
\openoutputfile{\currfiledir\theerlangshellsession.session}{erlangshellsession}
\writeverbatim{erlangshellsession}
}{
\endwriteverbatim
\closeoutputstream{erlangshellsession}
\begin{SingleSpacing}
\lstinputlisting[title={Erlang Shell}]{\currfiledir\theerlangshellsession.session}
\end{SingleSpacing}}

\IfFileExists{./.build}{
\newenvironment{SourceCode}{\comment}{\endcomment}
}{
\lstnewenvironment{SourceCode}{\SingleSpacing}{}
}

\lstnewenvironment{Listing}{\SingleSpacing}{}

\usepackage{tikz}

\ifdefined\DELAYANSWER
\usepackage[answerdelayed]{exercise}
\renewcommand{\AnswerHeader}{\textbf{\ExerciseName\ExerciseHeaderNB:\quad}}
\else
\usepackage{exercise}
\renewcommand{\AnswerHeader}{\textbf{答:\quad}}
\fi

\renewcommand{\ExerciseHeaderNB}{\thechapter.\theExercise}
\renewcommand{\ExerciseHeader}{
\textbf{\ExerciseName\ExerciseHeaderNB\ \ExerciseHeaderDifficulty\ExerciseTitle\ExerciseHeaderOrigin:}
}
\renewcounter{Exercise}[chapter]

\usepackage{chapterbib}
\usepackage[sectionbib]{natbib}

\newcommand\MakeBib{
\begingroup
\raggedright
\bibliographystyle{unsrt}
\bibliography{references}
\endgroup}


\usepackage{caption}
\DeclareCaptionFormat{listing}{\parbox{\textwidth}{\hrulefill {\vskip 2pt}

#1#2#3}}
\captionsetup[lstlisting]{format=listing,skip=12pt}

\renewcommand\lstlistlistingname{}
\renewcommand\ExerciseName{练习}
\renewcommand\bibname{参考}
\renewcommand\contentsname{目录}
\title{21天学通Erlang}
